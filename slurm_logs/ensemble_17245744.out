============================================================
ENSEMBLE CLIP + PLIP
Job ID: 17245744
Started: Tue Dec  2 17:54:41 CST 2025
============================================================
[17:56:51] ======================================================================
[17:56:51] ENSEMBLE CLASSIFIER: CLIP + PLIP
[17:56:51] ======================================================================
[17:56:52] Device: cuda
[17:56:52] 
Loading dataset...
[17:56:52] Loaded 45 samples
[17:59:18] Loading CLIP...
[17:59:25]   CLIP loaded!
[17:59:25] Loading PLIP...
[17:59:30]   PLIP loaded!
[17:59:30] Encoding text prompts...
[17:59:36]   Prompts encoded!
[17:59:36] 
==================================================
[17:59:36] Testing: class_assignment
[17:59:36] ==================================================
class_assignment:   0%|                                  | 0/45 [00:00<?, ?it/s]class_assignment:   0%|                       | 0/45 [00:13<?, ?it/s, acc=25.0%]class_assignment:   2%|▎              | 1/45 [00:13<09:44, 13.27s/it, acc=25.0%]class_assignment:   2%|▎              | 1/45 [00:13<09:44, 13.27s/it, acc=28.6%]class_assignment:   4%|▋              | 2/45 [00:13<04:10,  5.82s/it, acc=28.6%]class_assignment:   4%|▋              | 2/45 [00:16<04:10,  5.82s/it, acc=27.3%]class_assignment:   7%|█              | 3/45 [00:16<03:00,  4.30s/it, acc=27.3%]class_assignment:   7%|█              | 3/45 [00:18<03:00,  4.30s/it, acc=26.7%]class_assignment:   9%|█▎             | 4/45 [00:18<02:14,  3.29s/it, acc=26.7%]class_assignment:   9%|█▎             | 4/45 [00:18<02:14,  3.29s/it, acc=31.6%]class_assignment:  11%|█▋             | 5/45 [00:18<01:35,  2.38s/it, acc=31.6%]class_assignment:  11%|█▋             | 5/45 [00:21<01:35,  2.38s/it, acc=31.8%]class_assignment:  13%|██             | 6/45 [00:21<01:34,  2.42s/it, acc=31.8%]class_assignment:  13%|██             | 6/45 [00:22<01:34,  2.42s/it, acc=32.0%]class_assignment:  16%|██▎            | 7/45 [00:22<01:12,  1.91s/it, acc=32.0%]class_assignment:  16%|██▎            | 7/45 [00:25<01:12,  1.91s/it, acc=33.3%]class_assignment:  18%|██▋            | 8/45 [00:25<01:23,  2.27s/it, acc=33.3%]class_assignment:  18%|██▋            | 8/45 [00:28<01:23,  2.27s/it, acc=33.3%]class_assignment:  20%|███            | 9/45 [00:28<01:34,  2.63s/it, acc=33.3%]class_assignment:  20%|███            | 9/45 [00:29<01:34,  2.63s/it, acc=30.6%]class_assignment:  22%|███           | 10/45 [00:29<01:15,  2.15s/it, acc=30.6%]class_assignment:  22%|███           | 10/45 [00:34<01:15,  2.15s/it, acc=30.0%]class_assignment:  24%|███▍          | 11/45 [00:34<01:38,  2.90s/it, acc=30.0%]class_assignment:  24%|███▍          | 11/45 [00:37<01:38,  2.90s/it, acc=29.5%]class_assignment:  27%|███▋          | 12/45 [00:37<01:40,  3.04s/it, acc=29.5%]class_assignment:  27%|███▋          | 12/45 [00:39<01:40,  3.04s/it, acc=27.1%]class_assignment:  29%|████          | 13/45 [00:39<01:20,  2.51s/it, acc=27.1%]class_assignment:  29%|████          | 13/45 [00:39<01:20,  2.51s/it, acc=29.4%]class_assignment:  31%|████▎         | 14/45 [00:39<01:00,  1.95s/it, acc=29.4%]class_assignment:  31%|████▎         | 14/45 [00:40<01:00,  1.95s/it, acc=29.6%]class_assignment:  33%|████▋         | 15/45 [00:40<00:50,  1.68s/it, acc=29.6%]class_assignment:  33%|████▋         | 15/45 [00:42<00:50,  1.68s/it, acc=31.0%]class_assignment:  36%|████▉         | 16/45 [00:42<00:51,  1.78s/it, acc=31.0%]class_assignment:  36%|████▉         | 16/45 [00:48<00:51,  1.78s/it, acc=31.1%]class_assignment:  38%|█████▎        | 17/45 [00:48<01:25,  3.06s/it, acc=31.1%]class_assignment:  38%|█████▎        | 17/45 [00:54<01:25,  3.06s/it, acc=30.8%]class_assignment:  40%|█████▌        | 18/45 [00:54<01:42,  3.80s/it, acc=30.8%]class_assignment:  40%|█████▌        | 18/45 [00:56<01:42,  3.80s/it, acc=31.9%]class_assignment:  42%|█████▉        | 19/45 [00:56<01:24,  3.27s/it, acc=31.9%]class_assignment:  42%|█████▉        | 19/45 [00:58<01:24,  3.27s/it, acc=30.6%]class_assignment:  44%|██████▏       | 20/45 [00:58<01:11,  2.84s/it, acc=30.6%]class_assignment:  44%|██████▏       | 20/45 [00:59<01:11,  2.84s/it, acc=30.3%]class_assignment:  47%|██████▌       | 21/45 [00:59<00:59,  2.46s/it, acc=30.3%]class_assignment:  47%|██████▌       | 21/45 [01:01<00:59,  2.46s/it, acc=31.2%]class_assignment:  49%|██████▊       | 22/45 [01:01<00:50,  2.21s/it, acc=31.2%]class_assignment:  49%|██████▊       | 22/45 [01:03<00:50,  2.21s/it, acc=31.3%]class_assignment:  51%|███████▏      | 23/45 [01:03<00:45,  2.07s/it, acc=31.3%]class_assignment:  51%|███████▏      | 23/45 [01:06<00:45,  2.07s/it, acc=29.9%]class_assignment:  53%|███████▍      | 24/45 [01:06<00:50,  2.40s/it, acc=29.9%]class_assignment:  53%|███████▍      | 24/45 [01:06<00:50,  2.40s/it, acc=30.0%]class_assignment:  56%|███████▊      | 25/45 [01:06<00:35,  1.79s/it, acc=30.0%]class_assignment:  56%|███████▊      | 25/45 [01:09<00:35,  1.79s/it, acc=29.3%]class_assignment:  58%|████████      | 26/45 [01:09<00:39,  2.07s/it, acc=29.3%]class_assignment:  58%|████████      | 26/45 [01:15<00:39,  2.07s/it, acc=30.2%]class_assignment:  60%|████████▍     | 27/45 [01:15<01:00,  3.34s/it, acc=30.2%]class_assignment:  60%|████████▍     | 27/45 [01:18<01:00,  3.34s/it, acc=32.0%]class_assignment:  62%|████████▋     | 28/45 [01:18<00:54,  3.20s/it, acc=32.0%]class_assignment:  62%|████████▋     | 28/45 [01:20<00:54,  3.20s/it, acc=32.0%]class_assignment:  64%|█████████     | 29/45 [01:20<00:44,  2.77s/it, acc=32.0%]class_assignment:  64%|█████████     | 29/45 [01:22<00:44,  2.77s/it, acc=31.8%]class_assignment:  67%|█████████▎    | 30/45 [01:22<00:38,  2.55s/it, acc=31.8%]class_assignment:  67%|█████████▎    | 30/45 [01:22<00:38,  2.55s/it, acc=31.8%]class_assignment:  69%|█████████▋    | 31/45 [01:22<00:26,  1.87s/it, acc=31.8%]class_assignment:  69%|█████████▋    | 31/45 [01:25<00:26,  1.87s/it, acc=32.5%]class_assignment:  71%|█████████▉    | 32/45 [01:25<00:27,  2.12s/it, acc=32.5%]class_assignment:  71%|█████████▉    | 32/45 [01:26<00:27,  2.12s/it, acc=32.5%]class_assignment:  73%|██████████▎   | 33/45 [01:26<00:22,  1.84s/it, acc=32.5%]class_assignment:  73%|██████████▎   | 33/45 [01:27<00:22,  1.84s/it, acc=32.5%]class_assignment:  76%|██████████▌   | 34/45 [01:27<00:16,  1.53s/it, acc=32.5%]class_assignment:  76%|██████████▌   | 34/45 [01:27<00:16,  1.53s/it, acc=32.5%]class_assignment:  78%|██████████▉   | 35/45 [01:27<00:12,  1.21s/it, acc=32.5%]class_assignment:  78%|██████████▉   | 35/45 [01:28<00:12,  1.21s/it, acc=32.5%]class_assignment:  80%|███████████▏  | 36/45 [01:28<00:09,  1.08s/it, acc=32.5%]class_assignment:  80%|███████████▏  | 36/45 [01:29<00:09,  1.08s/it, acc=32.3%]class_assignment:  82%|███████████▌  | 37/45 [01:29<00:07,  1.04it/s, acc=32.3%]class_assignment:  82%|███████████▌  | 37/45 [01:33<00:07,  1.04it/s, acc=32.1%]class_assignment:  84%|███████████▊  | 38/45 [01:33<00:13,  1.87s/it, acc=32.1%]class_assignment:  84%|███████████▊  | 38/45 [01:33<00:13,  1.87s/it, acc=32.8%]class_assignment:  87%|████████████▏ | 39/45 [01:33<00:08,  1.36s/it, acc=32.8%]class_assignment:  87%|████████████▏ | 39/45 [01:34<00:08,  1.36s/it, acc=32.1%]class_assignment:  89%|████████████▍ | 40/45 [01:34<00:06,  1.24s/it, acc=32.1%]class_assignment:  89%|████████████▍ | 40/45 [01:36<00:06,  1.24s/it, acc=31.5%]class_assignment:  91%|████████████▊ | 41/45 [01:36<00:06,  1.59s/it, acc=31.5%]class_assignment:  91%|████████████▊ | 41/45 [01:37<00:06,  1.59s/it, acc=31.5%]class_assignment:  93%|█████████████ | 42/45 [01:37<00:04,  1.41s/it, acc=31.5%]class_assignment:  93%|█████████████ | 42/45 [01:39<00:04,  1.41s/it, acc=31.8%]class_assignment:  96%|█████████████▍| 43/45 [01:39<00:03,  1.58s/it, acc=31.8%]class_assignment:  96%|█████████████▍| 43/45 [01:40<00:03,  1.58s/it, acc=31.6%]class_assignment:  98%|█████████████▋| 44/45 [01:40<00:01,  1.46s/it, acc=31.6%]class_assignment:  98%|█████████████▋| 44/45 [01:41<00:01,  1.46s/it, acc=31.4%]class_assignment: 100%|██████████████| 45/45 [01:41<00:00,  1.18s/it, acc=31.4%]class_assignment: 100%|██████████████| 45/45 [01:41<00:00,  2.25s/it, acc=31.4%]
[18:01:17] 
class_assignment Results:
[18:01:17]   Overall: 31.41% (49/156)
[18:01:17]   tumor          :  4.44% (2/45)
[18:01:17]   stroma         : 15.56% (7/45)
[18:01:17]   lymphocyte     : 70.27% (26/37)
[18:01:17]   necrosis       : 60.87% (14/23)
[18:01:17]   blood_vessel   :  0.00% (0/6)
[18:01:17] 
==================================================
[18:01:17] Testing: probability_voting
[18:01:17] ==================================================
probability_voting:   0%|                                | 0/45 [00:00<?, ?it/s]probability_voting:   0%|                     | 0/45 [00:03<?, ?it/s, acc=75.0%]probability_voting:   2%|▎            | 1/45 [00:03<02:30,  3.43s/it, acc=75.0%]probability_voting:   2%|▎            | 1/45 [00:04<02:30,  3.43s/it, acc=57.1%]probability_voting:   4%|▌            | 2/45 [00:04<01:15,  1.76s/it, acc=57.1%]probability_voting:   4%|▌            | 2/45 [00:06<01:15,  1.76s/it, acc=54.5%]probability_voting:   7%|▊            | 3/45 [00:06<01:27,  2.08s/it, acc=54.5%]probability_voting:   7%|▊            | 3/45 [00:08<01:27,  2.08s/it, acc=46.7%]probability_voting:   9%|█▏           | 4/45 [00:08<01:19,  1.93s/it, acc=46.7%]probability_voting:   9%|█▏           | 4/45 [00:08<01:19,  1.93s/it, acc=47.4%]probability_voting:  11%|█▍           | 5/45 [00:08<01:00,  1.52s/it, acc=47.4%]probability_voting:  11%|█▍           | 5/45 [00:11<01:00,  1.52s/it, acc=45.5%]probability_voting:  13%|█▋           | 6/45 [00:11<01:11,  1.83s/it, acc=45.5%]probability_voting:  13%|█▋           | 6/45 [00:12<01:11,  1.83s/it, acc=44.0%]probability_voting:  16%|██           | 7/45 [00:12<00:57,  1.51s/it, acc=44.0%]probability_voting:  16%|██           | 7/45 [00:15<00:57,  1.51s/it, acc=46.7%]probability_voting:  18%|██▎          | 8/45 [00:15<01:13,  1.98s/it, acc=46.7%]probability_voting:  18%|██▎          | 8/45 [00:18<01:13,  1.98s/it, acc=45.5%]probability_voting:  20%|██▌          | 9/45 [00:18<01:26,  2.41s/it, acc=45.5%]probability_voting:  20%|██▌          | 9/45 [00:19<01:26,  2.41s/it, acc=44.4%]probability_voting:  22%|██▋         | 10/45 [00:19<01:09,  1.97s/it, acc=44.4%]probability_voting:  22%|██▋         | 10/45 [00:24<01:09,  1.97s/it, acc=42.5%]probability_voting:  24%|██▉         | 11/45 [00:24<01:32,  2.74s/it, acc=42.5%]probability_voting:  24%|██▉         | 11/45 [00:27<01:32,  2.74s/it, acc=40.9%]probability_voting:  27%|███▏        | 12/45 [00:27<01:35,  2.91s/it, acc=40.9%]probability_voting:  27%|███▏        | 12/45 [00:28<01:35,  2.91s/it, acc=37.5%]probability_voting:  29%|███▍        | 13/45 [00:28<01:17,  2.41s/it, acc=37.5%]probability_voting:  29%|███▍        | 13/45 [00:29<01:17,  2.41s/it, acc=39.2%]probability_voting:  31%|███▋        | 14/45 [00:29<00:58,  1.87s/it, acc=39.2%]probability_voting:  31%|███▋        | 14/45 [00:30<00:58,  1.87s/it, acc=37.0%]probability_voting:  33%|████        | 15/45 [00:30<00:48,  1.62s/it, acc=37.0%]probability_voting:  33%|████        | 15/45 [00:32<00:48,  1.62s/it, acc=37.9%]probability_voting:  36%|████▎       | 16/45 [00:32<00:50,  1.74s/it, acc=37.9%]probability_voting:  36%|████▎       | 16/45 [00:38<00:50,  1.74s/it, acc=37.7%]probability_voting:  38%|████▌       | 17/45 [00:38<01:24,  3.00s/it, acc=37.7%]probability_voting:  38%|████▌       | 17/45 [00:43<01:24,  3.00s/it, acc=36.9%]probability_voting:  40%|████▊       | 18/45 [00:43<01:41,  3.75s/it, acc=36.9%]probability_voting:  40%|████▊       | 18/45 [00:45<01:41,  3.75s/it, acc=37.7%]probability_voting:  42%|█████       | 19/45 [00:45<01:23,  3.23s/it, acc=37.7%]probability_voting:  42%|█████       | 19/45 [00:47<01:23,  3.23s/it, acc=36.1%]probability_voting:  44%|█████▎      | 20/45 [00:47<01:09,  2.78s/it, acc=36.1%]probability_voting:  44%|█████▎      | 20/45 [00:48<01:09,  2.78s/it, acc=35.5%]probability_voting:  47%|█████▌      | 21/45 [00:48<00:57,  2.38s/it, acc=35.5%]probability_voting:  47%|█████▌      | 21/45 [00:50<00:57,  2.38s/it, acc=36.2%]probability_voting:  49%|█████▊      | 22/45 [00:50<00:49,  2.15s/it, acc=36.2%]probability_voting:  49%|█████▊      | 22/45 [00:52<00:49,  2.15s/it, acc=34.9%]probability_voting:  51%|██████▏     | 23/45 [00:52<00:43,  1.97s/it, acc=34.9%]probability_voting:  51%|██████▏     | 23/45 [00:55<00:43,  1.97s/it, acc=34.5%]probability_voting:  53%|██████▍     | 24/45 [00:55<00:48,  2.31s/it, acc=34.5%]probability_voting:  53%|██████▍     | 24/45 [00:55<00:48,  2.31s/it, acc=35.6%]probability_voting:  56%|██████▋     | 25/45 [00:55<00:34,  1.73s/it, acc=35.6%]probability_voting:  56%|██████▋     | 25/45 [00:58<00:34,  1.73s/it, acc=34.8%]probability_voting:  58%|██████▉     | 26/45 [00:58<00:37,  2.00s/it, acc=34.8%]probability_voting:  58%|██████▉     | 26/45 [01:04<00:37,  2.00s/it, acc=35.4%]probability_voting:  60%|███████▏    | 27/45 [01:04<00:59,  3.28s/it, acc=35.4%]probability_voting:  60%|███████▏    | 27/45 [01:07<00:59,  3.28s/it, acc=36.0%]probability_voting:  62%|███████▍    | 28/45 [01:07<00:53,  3.14s/it, acc=36.0%]probability_voting:  62%|███████▍    | 28/45 [01:09<00:53,  3.14s/it, acc=35.9%]probability_voting:  64%|███████▋    | 29/45 [01:09<00:43,  2.72s/it, acc=35.9%]probability_voting:  64%|███████▋    | 29/45 [01:10<00:43,  2.72s/it, acc=35.5%]probability_voting:  67%|████████    | 30/45 [01:10<00:37,  2.48s/it, acc=35.5%]probability_voting:  67%|████████    | 30/45 [01:11<00:37,  2.48s/it, acc=34.5%]probability_voting:  69%|████████▎   | 31/45 [01:11<00:25,  1.82s/it, acc=34.5%]probability_voting:  69%|████████▎   | 31/45 [01:13<00:25,  1.82s/it, acc=35.1%]probability_voting:  71%|████████▌   | 32/45 [01:13<00:26,  2.06s/it, acc=35.1%]probability_voting:  71%|████████▌   | 32/45 [01:14<00:26,  2.06s/it, acc=35.0%]probability_voting:  73%|████████▊   | 33/45 [01:14<00:21,  1.77s/it, acc=35.0%]probability_voting:  73%|████████▊   | 33/45 [01:15<00:21,  1.77s/it, acc=34.2%]probability_voting:  76%|█████████   | 34/45 [01:15<00:16,  1.47s/it, acc=34.2%]probability_voting:  76%|█████████   | 34/45 [01:16<00:16,  1.47s/it, acc=33.3%]probability_voting:  78%|█████████▎  | 35/45 [01:16<00:11,  1.16s/it, acc=33.3%]probability_voting:  78%|█████████▎  | 35/45 [01:16<00:11,  1.16s/it, acc=33.3%]probability_voting:  80%|█████████▌  | 36/45 [01:16<00:09,  1.03s/it, acc=33.3%]probability_voting:  80%|█████████▌  | 36/45 [01:17<00:09,  1.03s/it, acc=33.1%]probability_voting:  82%|█████████▊  | 37/45 [01:17<00:07,  1.09it/s, acc=33.1%]probability_voting:  82%|█████████▊  | 37/45 [01:21<00:07,  1.09it/s, acc=32.8%]probability_voting:  84%|██████████▏ | 38/45 [01:21<00:12,  1.81s/it, acc=32.8%]probability_voting:  84%|██████████▏ | 38/45 [01:21<00:12,  1.81s/it, acc=32.8%]probability_voting:  87%|██████████▍ | 39/45 [01:21<00:07,  1.31s/it, acc=32.8%]probability_voting:  87%|██████████▍ | 39/45 [01:22<00:07,  1.31s/it, acc=32.1%]probability_voting:  89%|██████████▋ | 40/45 [01:22<00:05,  1.18s/it, acc=32.1%]probability_voting:  89%|██████████▋ | 40/45 [01:24<00:05,  1.18s/it, acc=31.5%]probability_voting:  91%|██████████▉ | 41/45 [01:24<00:06,  1.53s/it, acc=31.5%]probability_voting:  91%|██████████▉ | 41/45 [01:25<00:06,  1.53s/it, acc=31.5%]probability_voting:  93%|███████████▏| 42/45 [01:25<00:04,  1.35s/it, acc=31.5%]probability_voting:  93%|███████████▏| 42/45 [01:27<00:04,  1.35s/it, acc=31.8%]probability_voting:  96%|███████████▍| 43/45 [01:27<00:03,  1.52s/it, acc=31.8%]probability_voting:  96%|███████████▍| 43/45 [01:28<00:03,  1.52s/it, acc=31.6%]probability_voting:  98%|███████████▋| 44/45 [01:28<00:01,  1.40s/it, acc=31.6%]probability_voting:  98%|███████████▋| 44/45 [01:29<00:01,  1.40s/it, acc=31.4%]probability_voting: 100%|████████████| 45/45 [01:29<00:00,  1.14s/it, acc=31.4%]probability_voting: 100%|████████████| 45/45 [01:29<00:00,  1.98s/it, acc=31.4%]
[18:02:46] 
probability_voting Results:
[18:02:46]   Overall: 31.41% (49/156)
[18:02:46]   tumor          : 24.44% (11/45)
[18:02:46]   stroma         :  4.44% (2/45)
[18:02:46]   lymphocyte     : 51.35% (19/37)
[18:02:46]   necrosis       : 73.91% (17/23)
[18:02:46]   blood_vessel   :  0.00% (0/6)
[18:02:46] 
======================================================================
[18:02:46] SUMMARY
[18:02:46] ======================================================================
[18:02:46] 
Baselines:
[18:02:46]   CLIP only:     38.9%
[18:02:46]   PLIP only:     26.9%
[18:02:46] 
Ensemble:
[18:02:46]   class_assignment    : 31.4%
[18:02:46]   probability_voting  : 31.4%
[18:02:46] 
Results saved to: /scratch/user/shubhammhaske/vfm_project/results/ensemble_clip_plip/
============================================================
Completed: Tue Dec  2 18:02:54 CST 2025
============================================================
