============================================================
PLIP TEST: Pathology-Specific CLIP
Expected: 38.9% (CLIP) → 55-65% (PLIP)
Job ID: 17244550
Started: Tue Dec  2 15:42:20 CST 2025
============================================================
PLIP model path: /scratch/user/shubhammhaske/plip_model/plip_model
total 595936
drwxr-xr-x 2 shubhammhaske shubhammhaske      4096 Dec  2 15:39 .
drwxr-xr-x 3 shubhammhaske shubhammhaske      4096 Dec  2 15:38 ..
-rw-r--r-- 1 shubhammhaske shubhammhaske      1192 Dec  2 15:39 config.json
-rw-r--r-- 1 shubhammhaske shubhammhaske    524619 Dec  2 15:39 merges.txt
-rw-r--r-- 1 shubhammhaske shubhammhaske 605156676 Dec  2 15:39 model.safetensors
-rw-r--r-- 1 shubhammhaske shubhammhaske       504 Dec  2 15:39 preprocessor_config.json
-rw-r--r-- 1 shubhammhaske shubhammhaske       588 Dec  2 15:39 special_tokens_map.json
-rw-r--r-- 1 shubhammhaske shubhammhaske       803 Dec  2 15:39 tokenizer_config.json
-rw-r--r-- 1 shubhammhaske shubhammhaske   3642073 Dec  2 15:39 tokenizer.json
-rw-r--r-- 1 shubhammhaske shubhammhaske    862328 Dec  2 15:39 vocab.json
[15:44:50] ======================================================================
[15:44:50] PLIP TEST: Pathology-Specific CLIP for Tissue Classification
[15:44:50] ======================================================================
[15:44:50] Device: cuda
[15:44:50] GPU: NVIDIA A100-PCIE-40GB
[15:44:50] GPU Memory: 42.3 GB
[15:44:50] Loading dataset...
[15:44:50]   Image dir: /scratch/user/shubhammhaske/vfm_project/data/bcss/images
[15:44:50]   Mask dir: /scratch/user/shubhammhaske/vfm_project/data/bcss/masks
[15:44:50] Loaded 45 samples
[15:44:50] 
--------------------------------------------------
[15:44:50] Loading PLIP model...
[15:44:50]   This may take a few minutes on first run (downloading ~600MB)
[15:47:19]   Importing transformers library...
[15:47:19]   Loading PLIP from local path: /scratch/user/shubhammhaske/plip_model/plip_model
[15:47:25]   Model weights loaded!
[15:47:25]   Processor loaded!
[15:47:25]   Moving model to cuda...
[15:47:27]   PLIP loaded successfully!
[15:47:27]   Encoding text prompts...
[15:47:32]   Text prompts encoded!
[15:47:32] Text prompts encoded!
[15:47:32] 
--------------------------------------------------
[15:47:32] Running evaluation...
[15:47:32]   Processing 45 images...
Evaluating:   0%|                                        | 0/45 [00:00<?, ?it/s]Evaluating:   0%|                        | 0/45 [00:17<?, ?it/s, acc=25.0%, n=4]Evaluating:   2%|▎               | 1/45 [00:17<12:48, 17.48s/it, acc=25.0%, n=4]Evaluating:   2%|▎               | 1/45 [00:18<12:48, 17.48s/it, acc=28.6%, n=7]Evaluating:   4%|▋               | 2/45 [00:18<05:23,  7.51s/it, acc=28.6%, n=7]Evaluating:   4%|▋              | 2/45 [00:20<05:23,  7.51s/it, acc=27.3%, n=11]Evaluating:   7%|█              | 3/45 [00:20<03:31,  5.03s/it, acc=27.3%, n=11]Evaluating:   7%|█              | 3/45 [00:21<03:31,  5.03s/it, acc=26.7%, n=15]Evaluating:   9%|█▎             | 4/45 [00:21<02:29,  3.65s/it, acc=26.7%, n=15]Evaluating:   9%|█▎             | 4/45 [00:22<02:29,  3.65s/it, acc=31.6%, n=19]Evaluating:  11%|█▋             | 5/45 [00:22<01:43,  2.60s/it, acc=31.6%, n=19]Evaluating:  11%|█▋             | 5/45 [00:24<01:43,  2.60s/it, acc=31.8%, n=22]Evaluating:  13%|██             | 6/45 [00:24<01:34,  2.43s/it, acc=31.8%, n=22]Evaluating:  13%|██             | 6/45 [00:25<01:34,  2.43s/it, acc=32.0%, n=25]Evaluating:  16%|██▎            | 7/45 [00:25<01:12,  1.92s/it, acc=32.0%, n=25]Evaluating:  16%|██▎            | 7/45 [00:27<01:12,  1.92s/it, acc=26.7%, n=30]Evaluating:  18%|██▋            | 8/45 [00:27<01:18,  2.11s/it, acc=26.7%, n=30]Evaluating:  18%|██▋            | 8/45 [00:30<01:18,  2.11s/it, acc=24.2%, n=33]Evaluating:  20%|███            | 9/45 [00:30<01:23,  2.32s/it, acc=24.2%, n=33]Evaluating:  20%|███            | 9/45 [00:31<01:23,  2.32s/it, acc=25.0%, n=36]Evaluating:  22%|███           | 10/45 [00:31<01:07,  1.94s/it, acc=25.0%, n=36]Evaluating:  22%|███           | 10/45 [00:35<01:07,  1.94s/it, acc=25.0%, n=40]Evaluating:  24%|███▍          | 11/45 [00:35<01:22,  2.43s/it, acc=25.0%, n=40]Evaluating:  24%|███▍          | 11/45 [00:38<01:22,  2.43s/it, acc=25.0%, n=44]Evaluating:  27%|███▋          | 12/45 [00:38<01:25,  2.59s/it, acc=25.0%, n=44]Evaluating:  27%|███▋          | 12/45 [00:39<01:25,  2.59s/it, acc=22.9%, n=48]Evaluating:  29%|████          | 13/45 [00:39<01:09,  2.18s/it, acc=22.9%, n=48]Evaluating:  29%|████          | 13/45 [00:40<01:09,  2.18s/it, acc=25.5%, n=51]Evaluating:  31%|████▎         | 14/45 [00:40<00:54,  1.77s/it, acc=25.5%, n=51]Evaluating:  31%|████▎         | 14/45 [00:41<00:54,  1.77s/it, acc=24.1%, n=54]Evaluating:  33%|████▋         | 15/45 [00:41<00:46,  1.55s/it, acc=24.1%, n=54]Evaluating:  33%|████▋         | 15/45 [00:43<00:46,  1.55s/it, acc=25.9%, n=58]Evaluating:  36%|████▉         | 16/45 [00:43<00:47,  1.62s/it, acc=25.9%, n=58]Evaluating:  36%|████▉         | 16/45 [00:47<00:47,  1.62s/it, acc=26.2%, n=61]Evaluating:  38%|█████▎        | 17/45 [00:47<01:12,  2.60s/it, acc=26.2%, n=61]Evaluating:  38%|█████▎        | 17/45 [00:52<01:12,  2.60s/it, acc=26.2%, n=65]Evaluating:  40%|█████▌        | 18/45 [00:52<01:26,  3.20s/it, acc=26.2%, n=65]Evaluating:  40%|█████▌        | 18/45 [00:54<01:26,  3.20s/it, acc=26.1%, n=69]Evaluating:  42%|█████▉        | 19/45 [00:54<01:11,  2.74s/it, acc=26.1%, n=69]Evaluating:  42%|█████▉        | 19/45 [00:55<01:11,  2.74s/it, acc=25.0%, n=72]Evaluating:  44%|██████▏       | 20/45 [00:55<00:58,  2.36s/it, acc=25.0%, n=72]Evaluating:  44%|██████▏       | 20/45 [00:57<00:58,  2.36s/it, acc=25.0%, n=76]Evaluating:  47%|██████▌       | 21/45 [00:57<00:49,  2.07s/it, acc=25.0%, n=76]Evaluating:  47%|██████▌       | 21/45 [00:58<00:49,  2.07s/it, acc=26.2%, n=80]Evaluating:  49%|██████▊       | 22/45 [00:58<00:43,  1.88s/it, acc=26.2%, n=80]Evaluating:  49%|██████▊       | 22/45 [00:59<00:43,  1.88s/it, acc=26.5%, n=83]Evaluating:  51%|███████▏      | 23/45 [00:59<00:38,  1.75s/it, acc=26.5%, n=83]Evaluating:  51%|███████▏      | 23/45 [01:02<00:38,  1.75s/it, acc=26.4%, n=87]Evaluating:  53%|███████▍      | 24/45 [01:02<00:43,  2.06s/it, acc=26.4%, n=87]Evaluating:  53%|███████▍      | 24/45 [01:03<00:43,  2.06s/it, acc=27.8%, n=90]Evaluating:  56%|███████▊      | 25/45 [01:03<00:31,  1.58s/it, acc=27.8%, n=90]Evaluating:  56%|███████▊      | 25/45 [01:05<00:31,  1.58s/it, acc=27.2%, n=92]Evaluating:  58%|████████      | 26/45 [01:05<00:34,  1.82s/it, acc=27.2%, n=92]Evaluating:  58%|████████      | 26/45 [01:10<00:34,  1.82s/it, acc=26.0%, n=96]Evaluating:  60%|████████▍     | 27/45 [01:10<00:50,  2.78s/it, acc=26.0%, n=96]Evaluating:  60%|███████▊     | 27/45 [01:12<00:50,  2.78s/it, acc=27.0%, n=100]Evaluating:  62%|████████     | 28/45 [01:12<00:44,  2.64s/it, acc=27.0%, n=100]Evaluating:  62%|████████     | 28/45 [01:14<00:44,  2.64s/it, acc=26.2%, n=103]Evaluating:  64%|████████▍    | 29/45 [01:14<00:37,  2.33s/it, acc=26.2%, n=103]Evaluating:  64%|████████▍    | 29/45 [01:16<00:37,  2.33s/it, acc=26.2%, n=107]Evaluating:  67%|████████▋    | 30/45 [01:16<00:32,  2.13s/it, acc=26.2%, n=107]Evaluating:  67%|████████▋    | 30/45 [01:16<00:32,  2.13s/it, acc=26.4%, n=110]Evaluating:  69%|████████▉    | 31/45 [01:16<00:22,  1.62s/it, acc=26.4%, n=110]Evaluating:  69%|████████▉    | 31/45 [01:18<00:22,  1.62s/it, acc=28.1%, n=114]Evaluating:  71%|█████████▏   | 32/45 [01:18<00:23,  1.83s/it, acc=28.1%, n=114]Evaluating:  71%|█████████▏   | 32/45 [01:20<00:23,  1.83s/it, acc=27.4%, n=117]Evaluating:  73%|█████████▌   | 33/45 [01:20<00:19,  1.63s/it, acc=27.4%, n=117]Evaluating:  73%|█████████▌   | 33/45 [01:20<00:19,  1.63s/it, acc=26.7%, n=120]Evaluating:  76%|█████████▊   | 34/45 [01:20<00:14,  1.36s/it, acc=26.7%, n=120]Evaluating:  76%|█████████▊   | 34/45 [01:21<00:14,  1.36s/it, acc=26.0%, n=123]Evaluating:  78%|██████████   | 35/45 [01:21<00:10,  1.09s/it, acc=26.0%, n=123]Evaluating:  78%|██████████   | 35/45 [01:22<00:10,  1.09s/it, acc=27.0%, n=126]Evaluating:  80%|██████████▍  | 36/45 [01:22<00:08,  1.03it/s, acc=27.0%, n=126]Evaluating:  80%|██████████▍  | 36/45 [01:22<00:08,  1.03it/s, acc=26.9%, n=130]Evaluating:  82%|██████████▋  | 37/45 [01:22<00:07,  1.10it/s, acc=26.9%, n=130]Evaluating:  82%|██████████▋  | 37/45 [01:25<00:07,  1.10it/s, acc=26.9%, n=134]Evaluating:  84%|██████████▉  | 38/45 [01:25<00:10,  1.57s/it, acc=26.9%, n=134]Evaluating:  84%|██████████▉  | 38/45 [01:26<00:10,  1.57s/it, acc=27.7%, n=137]Evaluating:  87%|███████████▎ | 39/45 [01:26<00:07,  1.18s/it, acc=27.7%, n=137]Evaluating:  87%|███████████▎ | 39/45 [01:27<00:07,  1.18s/it, acc=27.1%, n=140]Evaluating:  89%|███████████▌ | 40/45 [01:27<00:05,  1.08s/it, acc=27.1%, n=140]Evaluating:  89%|███████████▌ | 40/45 [01:28<00:05,  1.08s/it, acc=26.6%, n=143]Evaluating:  91%|███████████▊ | 41/45 [01:28<00:05,  1.35s/it, acc=26.6%, n=143]Evaluating:  91%|███████████▊ | 41/45 [01:29<00:05,  1.35s/it, acc=26.7%, n=146]Evaluating:  93%|████████████▏| 42/45 [01:29<00:03,  1.25s/it, acc=26.7%, n=146]Evaluating:  93%|████████████▏| 42/45 [01:31<00:03,  1.25s/it, acc=27.0%, n=148]Evaluating:  96%|████████████▍| 43/45 [01:31<00:02,  1.39s/it, acc=27.0%, n=148]Evaluating:  96%|████████████▍| 43/45 [01:32<00:02,  1.39s/it, acc=27.0%, n=152]Evaluating:  98%|████████████▋| 44/45 [01:32<00:01,  1.29s/it, acc=27.0%, n=152]Evaluating:  98%|████████████▋| 44/45 [01:33<00:01,  1.29s/it, acc=26.9%, n=156]Evaluating: 100%|█████████████| 45/45 [01:33<00:00,  1.07s/it, acc=26.9%, n=156]Evaluating: 100%|█████████████| 45/45 [01:33<00:00,  2.07s/it, acc=26.9%, n=156]
[15:49:05] 
======================================================================
[15:49:05] RESULTS
[15:49:05] ======================================================================
[15:49:05] 
Overall Accuracy: 26.92% (42/156)
[15:49:05] 
Comparison to CLIP: 38.9% → 26.9%
[15:49:05] 
Per-Class Breakdown:
[15:49:05] --------------------------------------------------
[15:49:05]   tumor          : 46.67% ( 21/ 45)
[15:49:05]   stroma         :  8.89% (  4/ 45)
[15:49:05]   lymphocyte     : 16.22% (  6/ 37)
[15:49:05]   necrosis       : 47.83% ( 11/ 23)
[15:49:05]   blood_vessel   :  0.00% (  0/  6)
[15:49:05] 
Results saved to: /scratch/user/shubhammhaske/vfm_project/results/plip_test/metrics.json
============================================================
Completed: Tue Dec  2 15:49:35 CST 2025
============================================================
